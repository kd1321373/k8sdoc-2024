# マニフェスト

マニフェストは、K8sのリソース制御の際に使う宣言的文章で、一般的にYAML形式(`.yaml`, `.yml`)で記述します。
別の方法としてJSONもありますが、プログラム内で生成することが多く、テキストとして作成することは一般的ではないようです。

マニフェストの例として、ポッド(Pod)リソースの記述を使って説明します。
ポッド自体は後ほどもう少し詳しく解説します。

```{literalinclude} sources/pod-hw.yml
:language: yaml
:linenos:
```

- 1,2行目: マニフェストのバージョン情報
  - マニフェストでは、KubernetesにおけるAPIバージョンを指定します。このバージョンで記載された仕様にそった解釈を求めることになります
  - この例では、`apiVersion: v1`となっています。`v1`はKubernetesの最初のバージョンで、現在も使われています
  - 他にも`apps/v1`や`batch/v1`など、リソースの種類によって異なるバージョンがあります
  - また、`kind`によってリソースの種類を指定します。この例では`kind: Pod`となっています
- 3〜6行目: メタデータ情報
  - リソースにはメタデータ情報を持たせることができます
  - `name`はリソースの名前を指定します。この例では`metadata.name: hello-world`となっています
    - 他のリソースからは、リソース種類(kind)と名前(name)を指定して参照されます
- 7行目以降: スペック情報
  - リソースのスペック情報を指定します。この例では、`spec`に`containers`を指定しています
    - スペック情報とは、このリソースにおける『仕様』にあたるものです(specification)
  - `containers`はポッド内で動作するコンテナの情報を指定します。この例では、`name`と`image`を指定しています
    - `name`はコンテナの名前を指定します。この例では`name: hello-world`となっています
    - `image`はコンテナのイメージを指定します。この例では`image: hello-world`となっています

## マニフェストの適用について

マニフェストの適用は、ツアーで行ったように、`kubectl apply` コマンドで行います。

```bash
$ kubectl apply -f pod-hw.yml # 実際のファイルのパスにあわせてください
```

## リソースの名称

マニフェストを適用することで、`kind`キーで指定したリソースが生成されます。
リソース名は略称が使われることもあるため、正式名と異なっていることもたまにありますが、見ればおおむねわかると思います。
今回はPodリソースであり、名前が`hello-world`となっています。

名前はリソース名ごとに一意である必要はありますが、リソースを跨ぐと重複できます。そのため、リソースと名前で一意にします。
今回のケースでは、 `pod/hello-world` となります。ただしコマンドラインによっては`pod hello-world`と書かれることもあります。

